function studyInfo=wdrawmyscaleQ(studyInfo)
%   function studyInfo=wdrawmyscaleQ(studyInfo)
%
%   This funtion generates the drawmyscaleQ script for study experiments
%   created with the AudExpCreator.
%
% (c) Duc T. Nguyen and Blair Kaneshiro, 2017
% Distributed under Creative Commons Zero (CC0) license
% Contact: audexpcreator@gmail.com

line{1}=sprintf(['function drawmyscaleQ(wPtr, fontColor, xC, yC,'... 
    ' sL, x, %s, q, trigIndex)'], studyInfo.qStructName);

line{2}=sprintf('%% %s', line{1});
line{3}='% This function actually prints the question text and the question extremities';
line{4}='% (low and high) on the screen. This function also draws the slider on the screen,'; 
line{5}='% the end markers, and the sliding marker. ';
dLines=5;
line{dLines+1}='%';
line{dLines+2}='% This script was generated by AudExpCreator.';
line{dLines+3}='% (c) Duc T. Nguyen and Blair Kaneshiro, 2017';
line{dLines+4}='% Distributed under Creative Commons Zero (CC0) license';
line{dLines+5}='% Contact: audexpcreator@gmail.com';
dOS=5;

line{dOS+7}='Screen(''TextSize'', wPtr, 20);';
line{dOS+8}=sprintf('myQtext=%s(trigIndex).question{q};', studyInfo.qStructName);
line{dOS+9}='[~, ~, ~] = DrawFormattedText(wPtr, myQtext, ''center'', yC-100, fontColor);';
line{dOS+11}='Screen(''TextSize'', wPtr, 15);';
if strcmp(studyInfo.type,'Comparison Behav. Rating Study')
    line{dOS+12}=sprintf('myLtext=%s(trigIndex).qLow;', studyInfo.qStructName);
else
    line{dOS+12}=sprintf('myLtext=%s(trigIndex).qLow{q};', studyInfo.qStructName);
end
line{dOS+13}='[~, ~, ~] = DrawFormattedText(wPtr, myLtext, ''center'', ''center'', fontColor, ...';
line{dOS+14}='[], [], [], [], [], [(xC-sL)-250 yC+100 (xC-sL)+250 yC+200]);';
if strcmp(studyInfo.type,'Comparison Behav. Rating Study')
    line{dOS+16}=sprintf('myRtext=%s(trigIndex).qHigh;',studyInfo.qStructName);
else
    line{dOS+16}=sprintf('myRtext=%s(trigIndex).qHigh{q};',studyInfo.qStructName);
end
line{dOS+17}='[~, ~, ~] = DrawFormattedText(wPtr, myRtext, ''center'', ''center'', fontColor, ...';
line{dOS+18}='[], [], [], [], [], [(xC+sL)-250 yC+100 (xC+sL)+250 yC+200]);';
tabLine=[dOS+14 dOS+18];
subL=dOS+19;

if strcmp(studyInfo.type,'Comparison Behav. Rating Study')
    line{subL+1}='myCtext = ''SAME'';';
    line{subL+2}='[~, ~, ~] = DrawFormattedText(wPtr, myCtext, ''center'', ''center'', [255 255 255], ...';
    line{subL+3}='[], [], [], [], [], [xC-250 yC+100 xC+250 yC+200]);';
    tabLine=[tabLine subL+3];
    subL=subL+4;
end

line{subL+1}='Screen(''DrawLine'', wPtr, fontColor, (xC+sL ), (yC+200), ...';
line{subL+2}='(xC-sL), (yC+200), 2);';
line{subL+3}='Screen(''DrawLine'', wPtr, fontColor, (xC+sL ), (yC+180),...';
line{subL+4}='(xC+sL), (yC+220), 2);';
line{subL+5}='Screen(''DrawLine'', wPtr, fontColor, (xC-sL ), (yC+180),...';
line{subL+6}='(xC-sL), (yC+220), 2);';
line{subL+8}='if x<=(xC-sL)';
line{subL+9}='x=xC-sL;';
line{subL+10}='elseif x>=(xC+sL)';
line{subL+11}='x=(xC+sL);';
line{subL+12}='end';
line{subL+14}='Screen(''DrawLine'', wPtr, fontColor, x, yC+190, x, yC+210, 6);';
line{subL+15}='end';
tabLine=[tabLine subL+2 subL+4 subL+6 subL+9 subL+11];

studyInfo.fLine.drawmsQ = line{1}(10:end);

fName = 'drawmyscaleQ';
fID = fopen([studyInfo.path filesep fName '.m'],'w');
for i=1:length(line)
    if any(ismember(i,tabLine))
        fprintf(fID,'\t%s\n',line{i});
    else
        fprintf(fID,'%s\n',line{i});
    end
end
fclose(fID);
