function studyInfo=wfixedSliderTrial(studyInfo)
%   function studyInfo=wfixedSliderTrial(studyInfo)
%
%   This funtion generates the fixedSliderTrial script for study 
%    experiments created with the AudExpCreator.
%
% (c) Duc T. Nguyen and Blair Kaneshiro, 2017
% Distributed under Creative Commons Zero (CC0) license
% Contact: audexpcreator@gmail.com

line{1}=sprintf('function fixedSliderTrial(wPtr,wRect,bgColor,fontColor,duration,%s,trigIndex)',studyInfo.insStructName);
line{2}=sprintf('%% %s', line{1});
line{3}='% This function displays the fixed slider screen and prints the stim';
line{4}='% instruction on the screen along with the instruction low and high. This';
line{5}='% function draws the slider on the screen, and the end markers in a fixed';
line{6}='% setting in order to provide a time cushion between the prep screen and the';
line{7}='% stim/task screen. The fixed slider screen is set on a time duration to';
line{8}='% exit.';
dLines=8;
line{dLines+1}='%';
line{dLines+2}='% This script was generated by AudExpCreator.';
line{dLines+3}='% (c) Duc T. Nguyen and Blair Kaneshiro, 2017';
line{dLines+4}='% Distributed under Creative Commons Zero (CC0) license';
line{dLines+5}='% Contact: audexpcreator@gmail.com';
dOS=5;

line{dOS+9}='KbName(''UnifyKeyNames'');';
line{dOS+10}=sprintf('escapeKey = KbName(''%s'');',studyInfo.fQuitKey);

line{dOS+12}='[xC, yC] = RectCenter(wRect);';
line{dOS+13}='sL = 400;';

line{dOS+15}=sprintf('mytext=%s(trigIndex).instruction;',studyInfo.insStructName);
line{dOS+16}=sprintf('myLtext=%s(trigIndex).insLow;',studyInfo.insStructName);
line{dOS+17}=sprintf('myRtext=%s(trigIndex).insHigh;',studyInfo.insStructName);

line{dOS+19}='Screen(''FillRect'',wPtr,bgColor);';
line{dOS+21}='Screen(''TextSize'', wPtr, 20);';
line{dOS+22}='[~, ~, ~] = DrawFormattedText(wPtr, mytext, ''center'', yC-100, fontColor);';

line{dOS+24}='Screen(''TextSize'', wPtr, 15);';
line{dOS+25}='[~, ~, ~] = DrawFormattedText(wPtr, myLtext, ''center'', ''center'', fontColor,...';
line{dOS+26}='[], [], [], [], [], [(xC-sL)-250 yC+100 (xC-sL)+250 yC+200]);';
line{dOS+27}='[~, ~, ~] = DrawFormattedText(wPtr, myRtext, ''center'', ''center'', fontColor,...';
line{dOS+28}='[], [], [], [], [], [(xC+sL)-250 yC+100 (xC+sL)+250 yC+200]);';

line{dOS+30}='Screen(''DrawLine'', wPtr, fontColor, (xC+sL), (yC+200),...';
line{dOS+31}='(xC-sL), (yC+200), 2);';
line{dOS+32}='Screen(''DrawLine'', wPtr, fontColor, (xC+sL), (yC+180),...';
line{dOS+33}='(xC+sL), (yC+220), 2);';
line{dOS+34}='Screen(''DrawLine'', wPtr, fontColor, (xC-sL), (yC+180),...';
line{dOS+35}='(xC-sL), (yC+220), 2);';

line{dOS+37}='Screen(wPtr, ''Flip'');';
line{dOS+38}='HideCursor;';
line{dOS+39}='tic';
line{dOS+40}='while toc < duration';
line{dOS+41}='[ keyIsDown, ~, keyCode ] = KbCheck;';
line{dOS+42}='if keyIsDown';
line{dOS+43}='if  keyCode(escapeKey)';
line{dOS+44}='sca';
line{dOS+45}='end';
line{dOS+46}='end';
line{dOS+47}='end';

tabLine=[dOS+26 dOS+28 dOS+31 dOS+33 dOS+35 dOS+41:dOS+42 dOS+46];
dTabLine=[dOS+43 dOS+45];
tTabLine=dOS+44;

studyInfo.fLine.fTrial = line{1}(10:end);

fName = 'fixedSliderTrial';
fID = fopen([studyInfo.path filesep fName '.m'],'w');
for i=1:length(line)
    if any(ismember(i,tabLine))
        fprintf(fID,'\t%s\n',line{i});
    elseif any(ismember(i,dTabLine))
        fprintf(fID,'\t\t%s\n',line{i});
    elseif any(ismember(i,tTabLine))
        fprintf(fID,'\t\t\t%s\n',line{i});
    else
        fprintf(fID,'%s\n',line{i});
    end
end
fclose(fID);






